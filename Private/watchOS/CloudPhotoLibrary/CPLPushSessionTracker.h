//
//   Generated by https://github.com/blacktop/ipsw (Version: 3.1.454, BuildTime: 2024-02-08T22:07:34Z)
//
//    - LC_BUILD_VERSION:  Platform: watchOSSimulator, MinOS: 10.2, SDK: 10.2, Tool: ld (902.8)
//    - LC_SOURCE_VERSION: 624.0.100.0.0
//
#ifndef CPLPushSessionTracker_h
#define CPLPushSessionTracker_h
@import Foundation;

#include "CPLChangeBatch.h"
#include "CPLEngineIDMapping-Protocol.h"
#include "CPLEngineScopeStorage.h"
#include "CPLEngineStore.h"
#include "CPLPushChangeTasks.h"

@class NSArray, NSDate, NSDictionary, NSMutableArray, NSMutableDictionary, NSMutableSet, NSSet;

@interface CPLPushSessionTracker : NSObject {
  /* instance variables */
  CPLEngineScopeStorage *_scopes;
  NSObject<CPLEngineIDMapping> *_idMapping;
  NSMutableDictionary *_incomingBatchRecordPerScopedIdentifiers;
  NSMutableDictionary *_storedClientRecords;
  NSMutableDictionary *_storedCloudRecords;
  NSMutableArray *_changesWithResourceChanges;
  NSMutableDictionary *_fullRecords;
  BOOL _checkScopeIdentifier;
  NSMutableSet *_validScopeIdentifiers;
  NSMutableSet *_invalidScopeIdentifiers;
}

@property (readonly, nonatomic) CPLChangeBatch *incomingBatch;
@property (readonly, nonatomic) CPLEngineStore *store;
@property (readonly, nonatomic) CPLChangeBatch *expandedBatch;
@property (readonly, nonatomic) NSSet *unquarantinedRecordScopedIdentifiers;
@property (readonly, nonatomic) CPLPushChangeTasks *pushChangeTasks;
@property (readonly, nonatomic) BOOL hasPushChangeTasks;
@property (readonly, nonatomic) CPLChangeBatch *diffedBatch;
@property (readonly, nonatomic) NSArray *addedRecords;
@property (readonly, nonatomic) NSArray *updatedRecords;
@property (readonly, nonatomic) NSArray *deletedRecordScopedIdentifiers;
@property (readonly, nonatomic) NSDictionary *resourcesToUpload;
@property (readonly, nonatomic) NSDictionary *recordWithStatusChangesToNotify;
@property (readonly, nonatomic) NSArray *revertedChanges;
@property (readonly, nonatomic) unsigned long long ignoredRecordCount;
@property (readonly, nonatomic) BOOL diffedBatchCanLowerQuota;
@property (copy, nonatomic) NSDate *now;
@property (readonly, nonatomic) BOOL expandHasBeenSuccessful;
@property (readonly, nonatomic) BOOL diffHasBeenSuccessful;
@property (readonly, nonatomic) BOOL applyHasBeenSuccessful;

/* class methods */
+ (BOOL)notifyClientOfStore:(id)store ofStatusChanges:(id)changes error:(id *)error;

/* instance methods */
- (id)initWithIncomingBatch:(id)batch store:(id)store error:(id *)error;
- (BOOL)knowsClientRecordWithScopedIdentifier:(id)identifier;
- (id)_resourceIdentitiesFromChange:(id)change;
- (id)enqueuedOrStoredRecordWithLocalScopedIdentifier:(id)identifier;
- (id)resourceIdentitiesForRecordWithLocalScopedIdentifier:(id)identifier;
- (BOOL)checkScopeIdentifier:(id)identifier;
- (id)storedClientRecordWithLocalScopedIdentifier:(id)identifier;
- (BOOL)hasClientRecordWithLocalScopedIdentifier:(id)identifier;
- (id)storedCloudRecordWithLocalScopedIdentifier:(id)identifier;
- (void)acknowledgeNewClientRecord:(id)record withScopedIdentifier:(id)identifier;
- (BOOL)hasCloudRecordWithLocalScopedIdentifier:(id)identifier;
- (id)_realChangeFromChange:(id)change comparedToStoredRecord:(id)record changeType:(unsigned long long)type;
- (BOOL)computeExpandedBatchWithError:(id *)error;
- (BOOL)computeDiff;
- (void)enumerateDiffWithBlock:(id /* block */)block;
- (id)deletedRecordIdentifiers;
- (BOOL)notifyClientOfStatusChangesIfNecessaryWithError:(id *)error;
- (BOOL)shouldCancelSyncSessionTryingToUploadChange:(id)change;
@end

#endif /* CPLPushSessionTracker_h */
