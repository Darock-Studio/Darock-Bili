//
//   Generated by https://github.com/blacktop/ipsw (Version: 3.1.454, BuildTime: 2024-02-08T22:07:34Z)
//
//    - LC_BUILD_VERSION:  Platform: watchOSSimulator, MinOS: 10.2, SDK: 10.2, Tool: ld (902.8)
//    - LC_SOURCE_VERSION: 3774.300.42.0.0
//
#ifndef EDSearchableIndexPersistence_h
#define EDSearchableIndexPersistence_h
@import Foundation;

#include "EDDataDetectionPersistence.h"
#include "EDMessagePersistence.h"
#include "EDPersistenceDatabase.h"
#include "EDPersistenceDatabaseSchemaProvider-Protocol.h"
#include "EDRichLinkPersistence.h"
#include "EDSearchableIndexDataSource-Protocol.h"
#include "EDSearchableIndexHookResponder-Protocol.h"
#include "EFLoggable-Protocol.h"
#include "EFSignpostable-Protocol.h"

@class NSDictionary, NSString;

@interface EDSearchableIndexPersistence : NSObject<EFLoggable, EFSignpostable, EDPersistenceDatabaseSchemaProvider, EDSearchableIndexDataSource> {
  /* instance variables */
  atomic unsigned char _currentIndexingTypeIndex;
  struct os_unfair_lock_s { unsigned int _os_unfair_lock_opaque; } _lastProcessedAttachmentIDLock;
  EDDataDetectionPersistence *_dataDetectionPersistence;
}

@property (readonly, weak, nonatomic) NSObject<EDSearchableIndexHookResponder> *hookResponder;
@property (readonly, nonatomic) EDMessagePersistence *messagePersistence;
@property (readonly, nonatomic) EDRichLinkPersistence *richLinkPersistence;
@property unsigned long long rebuildIndexState;
@property long long lastProcessedAttachmentID;
@property (readonly, nonatomic) EDPersistenceDatabase *database;
@property (readonly, nonatomic) NSDictionary *statistics;
@property (readonly, nonatomic) NSString *additionalFilterClause;
@property (readonly) unsigned long long hash;
@property (readonly) Class superclass;
@property (readonly, copy) NSString *description;
@property (readonly, copy) NSString *debugDescription;
@property (readonly) unsigned long long signpostID;

/* class methods */
+ (id)log;
+ (id)signpostLog;
+ (id)searchableMessagesTableName;
+ (id)tablesAndForeignKeysToResolve:(id *)resolve associationsToResolve:(id *)resolve;
+ (id)searchableRebuildTableSchema;
+ (id)searchableMessagesTableSchema;
+ (id)searchableMessageTombstonesTableSchema;
+ (id)searchableAttachmentsTableSchema;
+ (id)searchableRichLinksTableSchema;
+ (id)searchableDataDetectionResultsTableSchema;

/* instance methods */
- (id)initWithDatabase:(id)database messagePersistence:(id)persistence richLinkPersistence:(id)persistence hookResponder:(id)responder;
- (id)messagesWhere:(id)where useSearchableRebuildTable:(BOOL)table limit:(long long)limit;
- (id)searchableIndexItemsFromMessages:(id)messages type:(long long)type;
- (void)attachmentItemMetadataForAttachmentID:(id)id messagePersistentID:(id)id name:(id)name mailboxID:(long long)id result:(id /* block */)result;
- (void)attachmentItemMetadataForAttachmentID:(id)id attachmentPersistentID:(id)id messagePersistentID:(id)id name:(id)name mailboxID:(long long)id result:(id /* block */)result;
- (id)searchableIndex:(id)index attachmentItemsForMessageWithIdentifier:(id)identifier;
- (id)verificationDataSamplesFromMessageIDTransactionIDDictionary:(id)iddictionary;
- (id)updatesForSearchableIndex:(id)index excludingIdentifiers:(id)identifiers count:(unsigned long long)count cancelationToken:(id)token;
- (id)_messagesRequiringIndexingForType:(long long)type excludingIdentifiers:(id)identifiers limit:(long long)limit;
- (long long)indexingTypeForSearchableIndex:(id)index item:(id)item;
- (BOOL)_canPerformIncrementalIndexForIdentifier:(id)identifier indexingType:(long long)type;
- (void)searchableIndex:(id)index assignIndexingType:(long long)type forIdentifiers:(id)identifiers;
- (void)searchableIndex:(id)index willRemoveIdentifiers:(id)identifiers type:(long long)type;
- (id)childIdentifiersToRemoveFromSearchableIndex:(id)index whenRemovingParentIdentifiers:(id)identifiers;
- (id)searchableIndex:(id)index assignTransaction:(long long)transaction updates:(id)updates;
- (void)searchableIndex:(id)index invalidateItemsGreaterThanTransaction:(long long)transaction;
- (id)searchableIndex:(id)index invalidateItemsInTransactions:(id)transactions;
- (void)searchableIndex:(id)index prepareToIndexAttachmentsForMessageWithIdentifier:(id)identifier;
- (id)verificationDataSamplesForSearchableIndex:(id)index count:(unsigned long long)count lastVerifiedMessageID:(long long)id;
- (id)distinctTransactionIDsForSearchableIndex:(id)index;
- (void)clearOrphanedSearchableMessagesFromDatabase;
- (id)_searchableIndexMessageIndexingTypes;
- (void)_enumerateSearchableIndexMessageIndexingTypesUsingBlock:(id /* block */)block;
- (id)_assignIndexedItems:(id)items connection:(id)connection query:(id)query indexedBindingsGenerator:(id /* block */)generator;
- (id)_assignIndexedItems:(id)items transaction:(long long)transaction connection:(id)connection;
- (void)_addTombstonesForIdentifiers:(id)identifiers type:(long long)type connection:(id)connection;
- (void)_assignTombstonesForIdentifiers:(id)identifiers type:(long long)type transaction:(long long)transaction connection:(id)connection;
- (void)_purgeSpotlightTombstonesBeforeTransaction:(long long)transaction connection:(id)connection;
- (id)_identifiersForTombstonesOfType:(long long)type connection:(id)connection;
- (void)_removeIndexedIdentifiers:(id)identifiers connection:(id)connection;
- (id)_identifiersForRemovedItemsUsingConnection:(id)connection;
- (id)_identifiersForDeletedMessagesUsingConnection:(id)connection;
- (id)_messageIDTransactionIDDictionaryToVerifyUsingConnection:(id)connection count:(unsigned long long)count lastVerifiedMessageID:(long long)id;
- (id)_attachmentDataForItemsRequiringIndexingExcludingIdentifiers:(id)identifiers limit:(unsigned long long)limit cancelationToken:(id)token connection:(id)connection;
- (id)_attachmentDataForMessageWithIdentifier:(id)identifier connection:(id)connection;
- (id)_attachmentItemsFromAttachmentData:(id)data limit:(unsigned long long)limit cancelationToken:(id)token;
- (id)_identifiersForDeletedAttachmentsUsingConnection:(id)connection;
- (id)_identifiersForAttachmentsInTransactions:(id)transactions usingConnection:(id)connection;
- (id)_identifiersForAttachmentsWithQuery:(id)query usingConnection:(id)connection;
- (id)_richLinkDataForItemsRequiringIndexingExcludingIdentifiers:(id)identifiers limit:(unsigned long long)limit cancelationToken:(id)token connection:(id)connection;
- (id)_richLinkItemsFromRichLinkData:(id)data limit:(unsigned long long)limit cancelationToken:(id)token;
- (void)searchableRichLinkItemMetadataForRichLinkID:(id)id richLinkItemIdentifier:(id)identifier messagePersistentID:(id)id mailboxID:(long long)id title:(id)title url:(id)url result:(id /* block */)result;
- (void)allMailboxIdentifiersForMessage:(id)message result:(id /* block */)result;
- (id)_assignIndexedAttachmentItems:(id)items transaction:(long long)transaction connection:(id)connection;
- (id)_assignIndexedRichLinkItems:(id)items transaction:(long long)transaction connection:(id)connection;
- (void)_assignIndexedDataDetectionItems:(id)items transaction:(long long)transaction connection:(id)connection;
- (void)_addSearchableDataDetectionResults:(id)results withMessage:(id)message transaction:(long long)transaction;
@end

#endif /* EDSearchableIndexPersistence_h */
