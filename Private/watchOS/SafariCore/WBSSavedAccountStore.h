//
//   Generated by https://github.com/blacktop/ipsw (Version: 3.1.454, BuildTime: 2024-02-08T22:07:34Z)
//
//    - LC_BUILD_VERSION:  Platform: watchOSSimulator, MinOS: 10.2, SDK: 10.2, Tool: ld (902.8)
//    - LC_SOURCE_VERSION: 617.1.17.12.4
//
#ifndef WBSSavedAccountStore_h
#define WBSSavedAccountStore_h
@import Foundation;

#include "WBSAuthenticationServicesAgentDelegate-Protocol.h"
#include "WBSAuthenticationServicesAgentProxy.h"
#include "WBSDiagnosticStateCollector.h"
#include "WBSKeychainCredentialNotificationMonitor.h"

@class NSArray, NSMutableDictionary, NSSet, NSTimer;
@protocol OS_dispatch_queue;

@interface WBSSavedAccountStore : NSObject<WBSAuthenticationServicesAgentDelegate> {
  /* instance variables */
  NSMutableDictionary *_personalKeychainHighLevelDomainToUsernameToPasswordToSavedAccounts;
  NSMutableDictionary *_personalKeychainUserHandleProtectionSpacePairsToSavedAccountsWithPasskeys;
  NSArray *_passkeysDataInPersonalKeychain;
  NSMutableDictionary *_highLevelDomainToLegacyPlatformAuthenticatorCredentials;
  WBSKeychainCredentialNotificationMonitor *_keychainMonitor;
  id _keychainNotificationRegistrationToken;
  NSObject<OS_dispatch_queue> *_queue;
  NSMutableDictionary *_allSavedAccountsHighLevelDomainToUsernameToCredentialTypesToSavedAccounts;
  WBSDiagnosticStateCollector *_stateCollector;
  NSTimer *_warmDataStoreAfterResetTimer;
  atomic int _isMigratingKeychainItemsWithInvalidAuthenticationTypes;
}

@property (readonly, nonatomic) WBSAuthenticationServicesAgentProxy *authenticationServicesAgentProxy;
@property (nonatomic) BOOL shouldWarmDataStoreAfterReset;
@property (readonly, nonatomic) NSArray *savedAccountsWithPasswords;
@property (readonly, nonatomic) NSArray *savedAccounts;
@property (readonly, nonatomic) NSArray *savedAccountsWithPasswordsExcludingNeverSaveMarkerPasswords;
@property (readonly, nonatomic) BOOL hasPasswordsEligibleForAutoFill;
@property (readonly, nonatomic) BOOL hasPasskeysEligibleForAutoFill;
@property (readonly, nonatomic) NSSet *highLevelDomainsOfAllSavedAccountsWithPasswordsExcludingNeverSaveMarkerPasswords;
@property (readonly, nonatomic) NSArray *savedAccountsExcludingNeverSaveMarkerPasswords;
@property (readonly, nonatomic) NSSet *highLevelDomainsOfAllSavedAccountsExcludingNeverSaveMarkerPasswords;

/* class methods */
+ (id)sharedStore;
+ (id)passkeysData;
+ (void)deletePasskeyWithIdentifier:(id)identifier;
+ (void)updateUserVisibleName:(id)name forPasskeyWithIdentifier:(id)identifier;

/* instance methods */
- (id)initAndPrewarmSavedAccounts:(BOOL)accounts;
- (id)initWithAuthenticationServicesAgentProxy:(id)proxy shouldPrewarmSavedAccounts:(BOOL)accounts;
- (id)_diagnosticStateDictionary;
- (void)dealloc;
- (id)savedAccountForURLCredential:(id)urlcredential protectionSpace:(id)space;
- (void)removeLegacyPlatformCredentialsForDomains:(id)domains;
- (void)savedAccountWithAllMetadataForURLCredential:(id)urlcredential protectionSpace:(id)space completion:(id /* block */)completion;
- (id)savedAccountWithAllMetadataForURLCredential:(id)urlcredential protectionSpace:(id)space;
- (id)savedAccountForURL:(id)url user:(id)user password:(id)password;
- (id)_savedAccountForProtectionSpace:(id)space user:(id)user password:(id)password;
- (id)savedAccountsForPersistentIdentifiers:(id)identifiers;
- (id)_allInternetPasswordEntriesFromPersonalKeychain;
- (id)_allSidecarsFromPersonalKeychain;
- (void)_warmDataStoreAfterResetTimerFired:(id)fired;
- (void)_prewarm;
- (id)_savedAccountsWithPasswords;
- (id)_loadSavedAccountsWithPasswordsFromKeychainData:(id)data withDictionaryForSavedAccountsWithPasswords:(id)passwords;
- (void)_matchSidecars:(id)sidecars toSavedAccountsWithPasswordsInDictionary:(id)dictionary unmatchedSidecars:(id)sidecars;
- (void)_reportKeychainItemsWithInvalidAuthenticationTypesIfNeeded;
- (id)_savedAccounts;
- (id)_loadSavedAccounts;
- (void)_fetchAndFilterAllPasskeysData;
- (void)_fetchAndFilterPasskeysData;
- (id)_loadAndMergeSavedAccountsFromPersonalKeychainIntoAllSavedAccounts:(id)accounts;
- (id)_loadSavedAccountsWithPasskeysFromPasskeyData:(id)data withDictionaryForSavedAccountsWithPasskeys:(id)passkeys;
- (void)_matchSidecars:(id)sidecars toSavedAccountsWithPasskeysInDictionary:(id)dictionary unmatchedSidecars:(id)sidecars;
- (id)_mergeSavedAccountsWithPasskeys:(id)passkeys andSavedAccountsWithPasswords:(id)passwords usingDictionaryForSavedAccountsWithPasswords:(id)passwords dictionaryForSavedAccountsWithPasskeys:(id)passkeys;
- (id)_mergeLoadedSavedAccounts:(id)accounts intoAllSavedAccounts:(id)accounts;
- (void)_removeSavedAccount:(id)account fromCachedCollectionsForCredentialTypes:(long long)types;
- (void)removeCredentialTypes:(long long)types forSavedAccount:(id)account;
- (void)_removeCredentialTypes:(long long)types forSavedAccount:(id)account;
- (void)removeSite:(id)site fromSavedAccountWithPassword:(id)password withCompletion:(id /* block */)completion;
- (BOOL)canChangeSavedAccount:(id)account toUser:(id)user password:(id)password;
- (BOOL)_canChangeSavedAccountInPersonalKeychain:(id)keychain toUser:(id)user password:(id)password;
- (void)changeSavedAccount:(id)account toUser:(id)user password:(id)password;
- (BOOL)canChangeSavedAccountWithRequest:(id)request;
- (void)changeSavedAccountWithRequest:(id)request;
- (void)_performLegacySidecarModificationWithChangeRequest:(id)request toSavedAccount:(id)account;
- (void)_updateSavedAccountsAndSavedAccountsWithPasswordsDictionary:(id)dictionary withChangeFromOldUser:(id)user oldPassword:(id)password forSavedAccountWithPassword:(id)password;
- (BOOL)canSaveUser:(id)user password:(id)password forUserTypedSite:(id)site notes:(id)notes error:(id *)error;
- (id)saveUser:(id)user password:(id)password forUserTypedSite:(id)site;
- (id)_saveAccountOnInternalQueueWithUser:(id)user password:(id)password forUserTypedSite:(id)site;
- (id)saveUser:(id)user password:(id)password forUserTypedSite:(id)site notesEntry:(id)entry;
- (id)saveUser:(id)user password:(id)password forUserTypedSite:(id)site customTitle:(id)title notesEntry:(id)entry;
- (BOOL)canSaveUser:(id)user password:(id)password forProtectionSpace:(id)space highLevelDomain:(id)domain notes:(id)notes error:(id *)error;
- (id)saveUser:(id)user password:(id)password forProtectionSpace:(id)space highLevelDomain:(id)domain;
- (id)_saveAccountOnInternalQueueWithUser:(id)user password:(id)password protectionSpace:(id)space highLevelDomain:(id)domain;
- (void)_saveSidecarObjectsOnInternalQueueForSavedAccount:(id)account withBlock:(id /* block */)block;
- (void)_saveSidecarObjectsOnInternalQueueForSavedAccountWithPassword:(id)password withBlock:(id /* block */)block;
- (void)_saveSidecarOnInternalQueueForSavedAccountWithPasskey:(id)passkey withBlock:(id /* block */)block;
- (void)_writeSidecarDataForMergedSavedAccount:(id)account;
- (void)saveTOTPGenerator:(id)totpgenerator forSavedAccount:(id)account;
- (void)removeTOTPGeneratorForSavedAccount:(id)account;
- (void)saveNotesEntry:(id)entry forSavedAccount:(id)account;
- (void)saveCustomTitle:(id)title forSavedAccount:(id)account;
- (void)saveHideMarker:(id)marker forSavedAccount:(id)account;
- (void)removeHideWarningMarkerForSavedAccount:(id)account;
- (void)resetHiddenSecurityRecommendationsWithCompletionHandler:(id /* block */)handler;
- (void)_postSavedAccountStoreDidChangeNotification;
- (unsigned long long)numberOfSavedAccountsInPersonalKeychainForHighLevelDomain:(id)domain;
- (void)reset;
- (void)_resetOnInternalQueue;
- (void)_cleanUpRedundantCredentialsWithoutUsernames;
- (void)_ensureDomainsToUsersExists;
- (void)_mergeSavedAccountWithPassword:(id)password toSavedAccountWithPasskey:(id)passkey;
- (void)_mergeSavedAccountWithPasskey:(id)passkey toSavedAccountWithPassword:(id)password;
- (void)setSavedAccountAsDefault:(id)default forProtectionSpace:(id)space;
- (void)setSavedAccountAsDefault:(id)default forProtectionSpace:(id)space context:(id)context;
- (void)updateAllSavedAccountsWithPasswordsWithUser:(id)user protectionSpace:(id)space withNewPassword:(id)password;
- (BOOL)_shouldUpdateLastUsedDateForSavedAccount:(id)account forProtectionSpace:(id)space inContext:(id)context;
- (id)savedAccountForUserTypedSite:(id)site userName:(id)name;
- (void)_migratePasswordsWithInvalidAuthenticationTypes;
- (BOOL)_isMigratingKeychainItemsWithInvalidAuthenticationTypes;
- (BOOL)_canPerformMaintenanceTasks;
- (void)performTaskEnsuringAllAccountSourcesAreLoadedOnQueue:(id)queue task:(id /* block */)task;
- (void)setDontSaveMarkerForSavedAccountsWithProtectionSpace:(id)space;
- (void)removeDontSaveMarkerForProtectionSpace:(id)space;
- (void)savedAccountsMatchingCriteria:(id)criteria withCompletionHandler:(id /* block */)handler;
- (id)_getSavedAccountsMatchingCriteriaOnInternalQueue:(id)queue;
- (void)getSavedAccountsMatchingCriteria:(id)criteria withSynchronousCompletionHandler:(id /* block */)handler;
- (id)getSavedAccountWithPasskeyCredentialForUserHandle:(id)handle protectionSpace:(id)space;
- (id)_relyingPartyURLForPasskeyCredentialIdentifierOnInternalQueue:(id)queue;
- (id)_getSavedAccountTreeMatchesWithCriteriaOnInternalQueue:(id)queue relyingPartyURL:(id)url;
- (id)_fetchCurrentAutoFillPasskeysWithCriteria:(id)criteria;
- (void)_pruneSavedAccountTreeMatchesOnInternalQueue:(id)queue basedOnUsernameAndPasswordCriteria:(id)criteria autoFillPasskeyIdentifiers:(id)identifiers;
- (id)_getSavedAccountMatchesFromSavedAccountTreeMatchesOnInternalQueue:(id)queue withCriteria:(id)criteria mergingAutoFillPasskeys:(id)passkeys nearbyDeviceOptions:(id)options;
- (void)newPasskeysAvailableForApplicationIdentifier:(id)identifier;
- (id)persistentIdentifierForCredential:(id)credential protectionSpace:(id)space;
- (id)persistentIdentifierForSavedAccount:(id)account;
- (id)_persistentIdentifierForUser:(id)user host:(id)host;
@end

#endif /* WBSSavedAccountStore_h */
