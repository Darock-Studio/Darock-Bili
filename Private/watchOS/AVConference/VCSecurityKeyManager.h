//
//   Generated by https://github.com/blacktop/ipsw (Version: 3.1.454, BuildTime: 2024-02-08T22:07:34Z)
//
//    - LC_BUILD_VERSION:  Platform: watchOSSimulator, MinOS: 10.2, SDK: 10.2, Tool: ld (902.8)
//    - LC_SOURCE_VERSION: 2005.6.1.3.2
//
#ifndef VCSecurityKeyManager_h
#define VCSecurityKeyManager_h
@import Foundation;

#include "VCMediaKeyIndex.h"

@class NSMutableArray, NSMutableDictionary;
@protocol OS_dispatch_queue, OS_dispatch_source;

@interface VCSecurityKeyManager : NSObject {
  /* instance variables */
  id _delegate;
  id _reportingAgentWeak;
  NSMutableArray *_unknownKeyIndexList;
  NSMutableDictionary *_sendKeys;
  NSMutableDictionary *_receiveKeys;
  NSMutableDictionary *_prunePendingReceiveKeys;
  VCMediaKeyIndex *_latestSendKeyIndex;
  VCMediaKeyIndex *_latestReceiveKeyIndex;
  VCMediaKeyIndex *_keyIndexNotReceived;
  BOOL _isSendKeysCleanUpPending;
  BOOL _isReceiveKeysCleanUpPending;
  BOOL _forceRemoteMKMMissing;
  double _keyMaterialNotUsedTimeout;
  NSObject<OS_dispatch_queue> *_keyManagerQueue;
  double _lastKeyIndexNotReceived;
  NSObject<OS_dispatch_source> *_pruneTimer;
  NSObject<OS_dispatch_source> *_encryptionKeyRollTimer;
  BOOL _isRunning;
}

@property (nonatomic) struct opaqueRTCReporting * reportingAgent;

/* instance methods */
- (id)initWithDelegate:(id)delegate;
- (void)dealloc;
- (id)delegate;
- (long long)getNotUsedTimeout;
- (id)logPrefix;
- (void)start;
- (void)stop;
- (void)releaseTimers;
- (BOOL)startTimers;
- (void)stopTimers;
- (BOOL)addSecurityKeyMaterial:(id)material;
- (id)getSendKeyMaterialWithIndex:(id)index;
- (id)getRecvKeyMaterialWithIndex:(id)index;
- (id)getLatestSendKeyMaterial;
- (id)getLatestRecvKeyMaterial;
- (void)pruneSendKeyMaterialWithDelay:(double)delay;
- (void)pruneRecvKeyMaterialWithDelay:(double)delay;
- (double)pruneAllExpiredKeys;
- (double)firstExpirationTime;
- (void)schedulePruneTimer:(double)timer;
- (void)handlePruneTimerEventAndReschedule;
- (void)scheduleEncryptionRollTimerWithDelay:(double)delay;
- (BOOL)associateMKI:(id)mki withClientID:(id)id;
- (id)copyMKMWithPrefix:(id)prefix;
@end

#endif /* VCSecurityKeyManager_h */
