//
//   Generated by https://github.com/blacktop/ipsw (Version: 3.1.454, BuildTime: 2024-02-08T22:07:34Z)
//
//    - LC_BUILD_VERSION:  Platform: watchOSSimulator, MinOS: 10.2, SDK: 10.2, Tool: ld (902.8)
//    - LC_SOURCE_VERSION: 582.60.2.0.0
//
#ifndef MCMCodeSigningMapping_h
#define MCMCodeSigningMapping_h
@import Foundation;

#include "MCMChildParentMapCache-Protocol.h"
#include "MCMManagedPath-Protocol.h"
#include "MCMSQLiteDB.h"
#include "MCMUserIdentityCache.h"

@protocol OS_dispatch_queue;

@interface MCMCodeSigningMapping : NSObject

@property (retain, nonatomic) MCMSQLiteDB *codeSigningMappingDB;
@property (readonly, nonatomic) MCMUserIdentityCache *userIdentityCache;
@property (readonly, nonatomic) NSObject<MCMManagedPath> *library;
@property (readonly, nonatomic) NSObject<OS_dispatch_queue> *queue;
@property (readonly, nonatomic) NSObject<MCMChildParentMapCache> *childParentMapCache;

/* class methods */
+ (id)codeSignMappingWithError:(id *)error;
+ (id)_moveDBIfNeededFromURL:(id)url queue:(id)queue error:(id *)error;

/* instance methods */
- (id)initWithUserIdentityCache:(id)cache queue:(id)queue mappingDB:(id)db childParentMapCache:(id)cache library:(id)library;
- (void)_onQueue_migrateFromMappingFileToDBIfNecessary;
- (void)migrateAppGroupIdsFromDataContainersToFile;
- (void)_onQueue_migrateAppGroupIdsFromDataContainersToFileUsingContainers:(id)containers;
- (void)_onQueue_migrateDataFromLegacyEntitlementsFileToCodeSigningFile;
- (void)migrateCachedCodeSigningInfoFromBundleContainersToMapping;
- (void)_onQueue_migrateCachedCodeSigningInfoFromBundleContainersToMappingWithContainersLegacy:(id)legacy containerClass:(unsigned long long)class;
- (void)_onQueue_migrateCachedCodeSigningInfoFromBundleContainerToMappingWithInfo:(id)info identifier:(id)identifier containerClass:(unsigned long long)class;
- (void)_onQueue_reconcileSystemContainersWithContext:(id)context;
- (void)performAllCodeSigningMigrationAndReconciliationWithContext:(id)context;
- (id)_readCodeSigningMappingFromDiskAtURL:(id)url;
- (id)_onQueue_setCodeSigningDictionaryValues:(id)values forIdentifiers:(id)identifiers;
- (id)_onQueue_codeSigningInfoForIdentifier:(id)identifier externalRequest:(BOOL)request;
- (id)_codeSigningInfoForCodeSigningEntry:(id)entry externalRequest:(BOOL)request;
- (id)_onQueue_entitlementsForIdentifier:(id)identifier;
- (id)_entitlementsFromCodeSigningEntry:(id)entry;
- (id)_onQueue_codeSigningEntryForIdentifier:(id)identifier withError:(id *)error;
- (BOOL)_onQueue_identifierHasCallerRegisteredEntitlements:(id)entitlements;
- (unsigned long long)_onQueue_dataContainerTypeForIdentifier:(id)identifier;
- (BOOL)_onQueue_processCodeSigningInfo:(id)info identifier:(id)identifier options:(id)options oldEntitlements:(id)entitlements error:(id *)error reconcileHandler:(id /* block */)handler;
- (id)_onQueue_invalidateCodeSigningInfoForIdentifierAndItsChildren:(id)children;
- (BOOL)_onQueue_invalidateCodeSigningInfoForIdentifier:(id)identifier error:(id *)error;
- (void)_onQueue_iterateGroupIdsWithKey:(id)key fallBackKey:(id)key forAllIdentifiersUsingBlock:(id /* block */)block;
- (id)groupContainerIdentifiersAssociatedWithIdentifier:(id)identifier containerClass:(unsigned long long)class;
- (id)removeCodeSigningDictionaryForIdentifiers:(id)identifiers;
- (id)codeSigningEntryForIdentifier:(id)identifier withError:(id *)error;
- (BOOL)identifierHasCallerRegisteredEntitlements:(id)entitlements;
- (BOOL)identifierHasSystemContainer:(id)container;
- (unsigned long long)dataContainerTypeForIdentifier:(id)identifier;
- (id)appGroupIdentifiersForIdentifier:(id)identifier;
- (id)systemGroupIdentifiersForIdentifier:(id)identifier;
- (id)processCallerRegisteredEntitlements:(id)entitlements identifier:(id)identifier error:(id *)error;
- (id)processCodeSigningInfo:(id)info identifier:(id)identifier options:(id)options error:(id *)error;
- (id)getCodeSigningInfoForIdentifier:(id)identifier;
- (id)entitlementsForIdentifier:(id)identifier;
- (unsigned long long)invalidateCodeSigningInfoForAppsWithoutDataContainer;
- (id)identifiersWithError:(id *)error;
- (id)_onQueue_identifiersWithError:(id *)error;
- (BOOL)invalidateCodeSigningInfoForIdentifierAndItsChildren:(id)children withError:(id *)error;
- (BOOL)invalidateCodeSigningInfoForIdentifier:(id)identifier withError:(id *)error;
- (id)copyReferenceCountSetForContainerClass:(unsigned long long)class;
- (id)_onQueue_copyReferenceCountSetForContainerClass:(unsigned long long)class;
- (void)_onQueue_handleChangeFromOldGroupContainerIds:(id)ids toNewGroupContainerIds:(id)ids containerClass:(unsigned long long)class reconcileHandler:(id /* block */)handler;
- (id)_onQueue_removeReferenceForGroupIdentifiers:(id)identifiers containerClass:(unsigned long long)class;
- (BOOL)removeAllAdvanceCopiesWithError:(id *)error;
- (BOOL)_onQueue_removeAllAdvanceCopiesWithError:(id *)error;
- (BOOL)removeAllInvalidPluginCodeSigningEntriesWithNumRemoved:(int *)removed error:(id *)error;
- (BOOL)_onQueue_removeAllInvalidPluginCodeSigningEntriesWithNumRemoved:(int *)removed error:(id *)error;
- (BOOL)enumerateOwnersAndGroupsWithGroupClass:(unsigned long long)class error:(id *)error block:(id /* block */)block;
- (BOOL)_onqueue_enumerateOwnersAndGroupsWithGroupClass:(unsigned long long)class error:(id *)error block:(id /* block */)block;
- (BOOL)addGroupIdentifier:(id)identifier forIdentifier:(id)identifier containerClass:(unsigned long long)class error:(id *)error reconcileHandler:(id /* block */)handler;
- (BOOL)removeGroupIdentifier:(id)identifier forIdentifier:(id)identifier containerClass:(unsigned long long)class error:(id *)error reconcileHandler:(id /* block */)handler;
- (BOOL)_onQueue_addGroupIdentifier:(id)identifier forIdentifier:(id)identifier containerClass:(unsigned long long)class error:(id *)error reconcileHandler:(id /* block */)handler;
- (BOOL)_onQueue_removeGroupIdentifier:(id)identifier forIdentifier:(id)identifier containerClass:(unsigned long long)class error:(id *)error reconcileHandler:(id /* block */)handler;
@end

#endif /* MCMCodeSigningMapping_h */
