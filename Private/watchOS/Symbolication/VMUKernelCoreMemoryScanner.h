//
//   Generated by https://github.com/blacktop/ipsw (Version: 3.1.454, BuildTime: 2024-02-08T22:07:34Z)
//
//    - LC_BUILD_VERSION:  Platform: watchOSSimulator, MinOS: 10.2, SDK: 10.2, Tool: ld (902.8)
//    - LC_SOURCE_VERSION: 64561.91.2.0.0
//
#ifndef VMUKernelCoreMemoryScanner_h
#define VMUKernelCoreMemoryScanner_h
@import Foundation;

#include "VMUClassInfoMap.h"
#include "VMUCommonGraphInterface-Protocol.h"
#include "VMUDebugTimer.h"
#include "VMUObjectIdentifier.h"
#include "VMUProcessObjectGraph.h"
#include "VMURangeArray.h"
#include "VMUScanOverlay.h"
#include "VMUTask.h"
#include "VMUTaskMemoryCache.h"
#include "VMUTaskThreadStates.h"
#include "VMUVMRegionIdentifier.h"

@class NSDictionary, NSMapTable, NSMutableArray, NSMutableDictionary, NSString;

@interface VMUKernelCoreMemoryScanner : NSObject<VMUCommonGraphInterface> {
  /* instance variables */
  VMUTask *_task;
  unsigned long long _suspendTime;
  unsigned int _suspensionToken;
  VMUVMRegionIdentifier *_regionIdentifier;
  unsigned int _blocksCount;
  unsigned int _blocksSize;
  unsigned int _regionsCount;
  struct _VMURegionMap { struct _VMUBlockNode * x0; unsigned int x1; unsigned long long x2; void * x3; struct _VMURegionNode * x4; unsigned int x5; unsigned long long x6; unsigned long long x7; unsigned int x8[0] } * _regionMap;
  BOOL _initializedRegionMallocBlockCounts;
  id /* block */ _regionInfoBlock;
  VMURangeArray *_stackRanges;
  NSMutableArray *_zoneNames;
  struct _VMURange { unsigned long long location; unsigned long long length; } _dataSegmentsRangeInSharedCache;
  struct _VMURange { unsigned long long location; unsigned long long length; } _dataSegmentsRangeOutsideSharedCache;
  VMURangeArray *_dataSegmentsRangeArrayOutsideSharedCache;
  BOOL _targetProcessHasObjCPatches;
  NSMutableDictionary *_addressToRuntimeMetadataChunkInfoDict;
  struct _VMUZoneNode { unsigned long long x0; id x1; struct malloc_introspection_t * x2; } * _zones;
  unsigned int _zonesCount;
  unsigned int _zonesSize;
  VMUTaskThreadStates *_threadStates;
  unsigned int _threadsCount;
  struct _VMUInstanceValues { unsigned long long x0; id x1; } * _instanceValues;
  unsigned int _instanceValuesCount;
  unsigned int _instanceValuesSize;
  id * _classInfos;
  unsigned int _classInfosCount;
  VMUClassInfoMap *_classInfoIndexer;
  struct _VMUScanLocationCache * * _scanCaches;
  void * _applySwiftMaskingToIsa;
  unsigned int _autoreleasePoolBoundaryNode;
  unsigned int _recordAutoreleasePoolBoundaries;
  NSMutableDictionary *_mappedFileNameToLengthDict;
  NSMapTable *_classStructureAddressToDestinationMapTable;
  unsigned int _objcClassStructureClassInfoIndex;
  unsigned int _classDataMethodsClassInfoIndex;
  unsigned int _swiftClassStructureClassInfoIndex;
  unsigned int _swiftMetadataClassInfoIndex;
  unsigned int _swiftHeapGenericLocalVariableClassInfoIndex;
  unsigned int _swiftMetadataMinBlockIndex;
  unsigned int _swiftMetadataMaxBlockIndex;
  unsigned long long _regionDescriptionOptions;
  id /* block */ _referenceLogger;
  id /* block */ _nodeLogger;
  VMUProcessObjectGraph *_processObjectGraph;
  void * _userMarkedAbandoned;
  NSMutableDictionary *_variantCachesByIsaIndex;
  NSMutableDictionary *_srcAddressToExtraAutoreleaseCountDict;
  unsigned long long _cfPasteboardReservedBase;
}

@property (readonly, nonatomic) unsigned long long suspendTimeContinuous;
@property (readonly, nonatomic) VMUTaskMemoryCache *memoryCache;
@property (readonly, nonatomic) VMUObjectIdentifier *objectIdentifier;
@property (readonly, nonatomic) VMUScanOverlay *scanOverlay;
@property (readonly, nonatomic) struct _VMURegionNode { id x0; unsigned int * x1; unsigned int x2; unsigned int x3; unsigned long long x4; unsigned long long x5; unsigned long long x6; void * x7; struct _VMURegionNode * x8; } * regions;
@property (readonly, nonatomic) struct _VMUBlockNode { unsigned long long x0; unsigned int x1 :3; unsigned int x2 :2; unsigned int x3 :36; unsigned int x4 :23; } * blocks;
@property (nonatomic) BOOL abandonedMarkingEnabled;
@property (nonatomic) BOOL recordRuntimeMetadataChunkInfo;
@property (nonatomic) BOOL exactScanningEnabled;
@property (nonatomic) unsigned long long maxInteriorOffset;
@property (nonatomic) unsigned int scanningMask;
@property (retain, nonatomic) VMUDebugTimer *debugTimer;
@property (nonatomic) BOOL showRawClassNames;
@property (nonatomic) unsigned int objectContentLevel;
@property (readonly, nonatomic) unsigned int nodeCount;
@property (readonly, nonatomic) unsigned int zoneCount;
@property (readonly, nonatomic) unsigned int mallocNodeCount;
@property (readonly, nonatomic) VMUClassInfoMap *realizedClasses;
@property (readonly, nonatomic) int pid;
@property (readonly, nonatomic) BOOL is64bit;
@property (readonly, nonatomic) BOOL isTranslatedByRosetta;
@property (readonly, nonatomic) unsigned int vmPageSize;
@property (readonly, nonatomic) unsigned int kernelPageSize;
@property (readonly, nonatomic) BOOL hasClassInfosDerivedFromStackBacktraces;
@property (readonly, nonatomic) unsigned int regionCount;
@property (readonly, nonatomic) unsigned int nodeNamespaceSize;
@property (readonly, nonatomic) NSString *processName;
@property (readonly, nonatomic) NSString *processDescriptionString;
@property (readonly, nonatomic) NSString *executablePath;
@property (readonly, nonatomic) NSString *binaryImagesDescription;
@property (readonly, nonatomic) unsigned long long physicalFootprint;
@property (readonly, nonatomic) unsigned long long physicalFootprintPeak;
@property (readonly, nonatomic) NSDictionary *ledger;
@property (readonly, nonatomic) unsigned int idleExitStatus;
@property (readonly) unsigned long long hash;
@property (readonly) Class superclass;
@property (readonly, copy) NSString *description;
@property (readonly, copy) NSString *debugDescription;

/* class methods */
+ (void)initialize;

/* instance methods */
- (id)vmuTask;
- (void)unmapAllRegions;
- (void)dealloc;
- (void)_withMemoryReaderBlock:(id /* block */)block;
- (void)_callRemoteMallocEnumerators:(unsigned int)enumerators block:(id /* block */)block;
- (void)_destroyLinearClassInfos;
- (unsigned int)_indexForClassInfo:(id)info;
- (id)_cachedVariantForGenericInfo:(id)info variantKey:(unsigned long long)key;
- (void)_registerVariant:(id)variant forGenericInfo:(id)info variantKey:(unsigned long long)key;
- (void)_updateLinearClassInfos;
- (void)_addThreadNodesFromTask;
- (void)_addSpecialNodesFromTask;
- (unsigned long long)_lengthOfMappedFileOfRegion:(id)region;
- (void)_shortenScannableRangeOfMappedFile:(unsigned int)file;
- (void)addRootNodesFromTask;
- (id)_readonlyRegionRanges;
- (void)_sortBlocks;
- (void)addMallocNodesFromTask;
- (void)addMallocNodes:(id)nodes;
- (void)_sortAndClassifyBlocks;
- (void)setClassStructureFieldScanValueAtSourceAddress:(void *)address toCorrectedAddress:(void *)address;
- (void)printRuntimeMetadataInfo;
- (void)_fixupBlockIsas;
- (void)_identifyNonObjectsPointedToByTypedIvars:(unsigned int)ivars;
- (void)_findMarkedAbandonedBlocks;
- (void)refineTypesWithOverlay:(id)overlay;
- (void)applyTypeOverlayToMutableInfo:(id)info;
- (void)_buildRegionFirstBlockIndexOnPageArrays;
- (void)_withOrderedNodeMapper:(id /* block */)mapper;
- (void)scanNodesWithReferenceRecorder:(id /* block */)recorder;
- (unsigned int)_removeFalsePositiveLeakedVMregionsFromNodes:(unsigned int *)nodes nodeCount:(unsigned int)count recorder:(id /* block */)recorder;
- (id)processSnapshotGraphWithOptions:(unsigned long long)options;
- (id)processSnapshotGraph;
- (struct { unsigned long long x0; unsigned int x1 :60; unsigned int x2 :4; id x3; })nodeDetails:(unsigned int)details;
- (id)vmuVMRegionForAddress:(unsigned long long)address;
- (id)vmuVMRegionForNode:(unsigned int)node;
- (id)zoneNameForNode:(unsigned int)node;
- (id)zoneNameForIndex:(unsigned int)index;
- (BOOL)hasLabelsForNodes;
- (id)labelForNode:(unsigned int)node;
- (id)shortLabelForNode:(unsigned int)node;
- (void *)contentForNode:(unsigned int)node;
- (id)classInfoForObjectAtAddress:(unsigned long long)address;
- (BOOL)addressIsInDataSegment:(unsigned long long)segment;
- (void)clearCrashReporterInfoForMappedFileRegion;
- (unsigned int)enumerateNodesWithBlock:(id /* block */)block;
- (unsigned int)enumerateObjectsWithBlock:(id /* block */)block;
- (unsigned int)enumerateMarkedObjects:(void *)objects withBlock:(id /* block */)block;
- (unsigned int)enumerateRegionsWithBlock:(id /* block */)block;
- (unsigned int)enumerateReferencesWithBlock:(id /* block */)block;
- (unsigned int)nodeForAddress:(unsigned long long)address;
- (unsigned int)_nodeForAddress:(unsigned long long)address checkMaxInteriorOffset:(BOOL)offset;
- (void *)copyUserMarked;
- (unsigned long long)ledgerValueForKey:(id)key keyExists:(BOOL *)exists;
- (void)setNodeScanningLogger:(id /* block */)logger;
- (void)setReferenceScanningLogger:(id /* block */)logger;
@end

#endif /* VMUKernelCoreMemoryScanner_h */
